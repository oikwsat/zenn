---
title: "Webページレンダリングの仕組みと手法（CSR, SSR, SSG, ISR, ISG）"
emoji: "📘"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: [javascript, web, nextjs, frontend]
published: false
---

## サーバーサイドの処理の流れ

まずはじめに、ブラウザ側とサーバ側のやりとりについて軽く解説します。

サーバ

### 静的ページ

静的ページは、固定されたコンテンツを持つページで、DB とのやりとりを必要としません。HTML、CSS、JavaScrpt などの静的なファイルから構成され、一度作成されたらコンテンツが変化しない特徴があります。
企業のホームページや LP などが該当します。

コンテンツを描画するまでの流れは以下の通りです。

1. ブラウザ（クライアント）がリクエストを送信する
2. Web サーバはリクエストを受け取り、対象の HTML ファイルをレスポンスとして送信する
3. ブラウザはレスポンスとして受け取った HTML ファイルを解析する
4. 解析中に CSS、JavaScript、画像などの読み込みコードがあれば、ブラウザはそれぞれのリソースを都度リクエストする
5. Web サーバはリクエストを受け取り、対象の CSS ファイル、JavaScript ファイル、画像ファイルなどをレスポンスとして送信する
6. ブラウザは取得した HTML, CSS, JS 等のリソースを基にコンテンツを描画する

HTML, CSS, JavaScript, 画像などのファイルを Web サーバに置いておき、リクエストを受けたら対象のファイルを返すだけのシンプルな処理です。
ページ遷移は新しいリクエストになるので、その度に描画処理が走ります。

### 動的ページ

一方、動的ページでは、リクエストごとに DB とのやりとりを行い、コンテンツを生成します。そのため、ユーザの要求やデータの状態に基づいてコンテンツが変化します。
オンラインショップや SNS、SaaS などの Web アプリケーションが該当します。

コンテンツを描画するまでの流れは以下の通りです。

1. ブラウザ（クライアント）がリクエストを送信する。
2. Web サーバはリクエストを受け取り、それをアプリケーションサーバに転送する
3. アプリケーションサーバはリクエストを受け取り、必要なデータを DB サーバから取得するためのクエリを発行し、送信する
4. DB サーバは受け取ったクエリを処理し、結果をアプリケーションサーバに返す
5. アプリケーションサーバは受け取ったデータを基に HTML や JSON データを生成し、Web サーバに送信する
6. Web サーバは受け取った HTML をブラウザへ送信する
7. ブラウザはレスポンスとして受け取った HTML ファイルを解析する
8. 解析中に CSS、JavaScript、画像などの読み込みコードがあれば、ブラウザはそれぞれのリソースを都度リクエストする
9. Web サーバはリクエストを受け取り、対象の CSS ファイル、JavaScript ファイル、画像ファイルなどをレスポンスとして送信する
10. ブラウザは取得した HTML, CSS, JS 等のリソースを基にコンテンツを描画する

## ブラウザレンダリングの流れ

ブラウザがリソースを取得後、それらを画面上に表示するための描画処理を行うことを**ブラウザレンダリング**と呼びます。（正確には分かりませんが、他の記事の多くはそのように定義していました）
ブラウザレンダリングは大きく 4 つのプロセスに分けられます。

- Loading
- Scripting
- Rendering
- Painting

### Loading

ブラウザが一番最初に行うのは Loading です。
Loagind の主な役割はリソースの読み込みとリソースの解析（パース）です。
ブラウザははじめに、HTML ファイルを
ブラウザはこの HTML ファイルを上の行から順に読み込み、途中で CSS や JavaScript、画像などの外部のリソースを見つけると、それらのファイルを取得するために
