---
title: "能動的攻撃と受動的攻撃"
---

Web アプリケーションに対する攻撃は、能動的攻撃と受動的攻撃に分類される。

## 能動的攻撃

攻撃者が Web サーバーに対して直接攻撃すること。
代表例として SQL インジェクションがある。

![](https://storage.googleapis.com/zenn-user-upload/53df83b438cd-20231217.png)

## 受動的攻撃

攻撃者がサーバーを直接攻撃するのではなく、Web サイトの利用者に罠を仕掛けることにより、罠を閲覧したユーザを通してアプリケーションを攻撃する手法。

### 単純な受動的攻撃

罠サイトに利用者を誘導するパターン。

![](https://storage.googleapis.com/zenn-user-upload/add3fabc23a0-20231217.png)

- このケースの典型例は、いわゆる「怪しいサイト」を閲覧してマルウェア（ウイルスなどの不正プログラム）に感染する場合
- ブラウザに脆弱性がなければ、このような単純な受動的攻撃は成立しない

### 正規サイトを悪用する受動的攻撃

正規のサイトに罠が仕込まれるケース。

![](https://storage.googleapis.com/zenn-user-upload/92aa7d2814d1-20231217.png)

- 攻撃者はあらかじめ正規サイトを攻撃してコンテンツに仕掛けを仕込む（①）
- 正規サイトの利用者が仕掛けを含むコンテンツを閲覧する（②~③）
- マルウェア感染などが起こる（④）

- ① だけを見ると能動的攻撃
- ②~④ は受動的攻撃
- したがって、① は受動的攻撃の準備

正規サイトを悪用した受動的攻撃は、罠サイトを用いる単純なパターンに比べて攻撃の手間がかかるが、その分、以下に示すように攻撃側にとって「メリット」が大きい。

- 罠サイトに誘導する手間が要らない
- 正規サイトは利用者が多いので被害が拡大する可能性が高い
- 正規サイトの機能を不正利用することにより攻撃者にメリットが得られる
- 利用者の個人情報を盗むことにより攻撃者にメリットが得られる

#### 正規サイトに罠を仕込む手法

- FTP などのパスワードを不正入手してコンテンツを書き換える
- Web サーバーの脆弱性をついた攻撃によりコンテンツを書き換える
- SQL インジェクション攻撃によりコンテンツを書き換える
- SNS など利用者が投稿できるサイト機能のクロスサイト・スクリプティング脆弱性を悪用する

### サイトをまたがった受動的攻撃

罠サイトと正規サイトをまたがった攻撃。

![](https://storage.googleapis.com/zenn-user-upload/2819c773ebcb-20231217.png)

手順は以下の通り。

1. 利用者が罠サイトを閲覧する
2. 罠サイトから仕掛けを含む HTML をダウンロードする
3. HTML の仕掛けが発動して正規サイトに攻撃のリクエストを送信する
4. 正規サイトから JavaScript などの仕掛けを含むレスポンスが返る

- 特徴は、**正規サイトにログインしている利用者のアカウントを悪用した攻撃**であること
- ③ のリクエストでセッションクッキーを正規サイトに送信するため、利用者が正規サイトにログイン状態であれば、ログインした状態で攻撃が実行される
- このパターンの攻撃の典型は
  - ③ のリクエストで Web アプリケーションを攻撃するタイプが CSRF
  - ④ のレスポンスによりブラウザを介して攻撃するタイプが XSS やや HTTP ヘッダ・インジェクション

## ブラウザはどのように受動的攻撃を防ぐか

- 受動的攻撃に対しては、ブラウザと Web サイトそれぞれで対策を行う必要がある
- Web サイト側の対策はたくさんあるが、その対策はブラウザのセキュリティに問題がないことを前提としている
- ブラウザに問題がある場合、Web サイト側で対策を行っても安全を確保できない

### サンドボックス

- ブラウザ上では、サイトを閲覧した状態でプログラム（JavaScript、Java アプレット、AdobeFlashPlayer など）を実行する機能が提供されている
- そのため、利用者のブラウザで悪意あるプログラムが動かないように、JavaScript などは安全性を高めるための機能を提供している
- どのような機能かというと、
  - **プログラムの「できること」を制限するサンドボックスという環境を用意する**
- サンドボックス（sandbox）は、JavaScript や Java アプレット、AdobeFlashPlayer などで採用されている考え方
- サンドボックスの中では、プログラムができることに制約がある
- 悪意のプログラムを作ろうとしても利用者に被害が及ばないように配慮されている
- JavaScript のサンドボックスでは以下のように制限されている
  - ローカルファイルへのアクセスの禁止
  - プリンタなどの資源の利用禁止（画面表示は可能）
  - ネットワークアクセスの制限（同一オリジンポリシー）
- **同一オリジンポリシー**は完全な禁止ではないが、厳しい制約がある
