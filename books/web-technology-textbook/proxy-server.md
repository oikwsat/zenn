---
title: "プロキシサーバ"
---

- Web の高速化を可能にする技術として、**プロキシ機能**がある
- プロキシにはクライアント側とサーバー側の 2 種類が存在する

## プロキシサーバとは

- **プロキシ（Proxy）** と呼ばれる機能を持つサーバ

- プロキシの意味は「**代理**」
- プロキシサーバは、ブラウザと Web サーバ間のやりとりを中継する

![](https://storage.googleapis.com/zenn-user-upload/fb8bff8c77a6-20230727.png)

プロキシサーバにより以下のことなどが可能になる

- 中継の過程で、Web サーバから取得したデータをキャッシュする
- URL などの条件によってリクエスト先のサーバを変更する
  - 負荷分散により Web アクセスの高速化や大規模化が可能になる

## プロキシサーバを導入した Web システムの構造

- プロキシサーバの導入により、ブラウザと Web サーバ間の通信が中継される
- Web サーバから転送されるリソースをプロキシサーバが中継してブラウザに送信する
- プロキシサーバを導入した Web システムの場合、オリジナルのリソースを持った Web サーバを**オリジンサーバ**と呼ぶ

![](https://storage.googleapis.com/zenn-user-upload/8561bf4b31a7-20230727.png)

### プロキシサーバを経由したレスポンスメッセージ

- プロキシサーバを経由した場合は、レスポンスメッセージに**Via ヘッダー**が追加される
- 複数のプロキシサーバを経由した場合は、Via ヘッダーに中継したプロキシサーバの数だけホスト名やサーバソフトウェアの名称などの情報が付与される

![](https://storage.googleapis.com/zenn-user-upload/4e0eac4170a0-20230727.png)

### プロキシサーバの導入手段

プロキシサーバを導入するには、以下の手段がある。

- プロキシ機能を実現するソフトウェアをインストールしたサーバを使用する
- プロキシ機能に特化して作られた専用製品を利用する

通常、プロキシサーバには 2 つ以上のネットワークインターフェースがあり、1 つが Web サーバ側、もうつがブラウザ側に繋がるように接続する。
:::details ネットワーク・インターネット・ネットワークインターフェースについて

#### ネットワーク

- コンピューターやスマートフォンなどのデバイス同士がつながって情報をやり取りする仕組み
- 友達同士が電話やメッセージでコミュニケーションするように、デバイス同士がインターネットを通じてコミュニケーションする方法

#### インターネット

- 世界中の多くのコンピューターやネットワークが相互に接続された巨大なネットワーク
- 複数のローカルネットワークが互いに結びつき、地理的に離れた場所にいるコンピューター同士が通信できるようになっている

#### ネットワークインターフェース

- コンピューターやスマートフォンなどのデバイスがインターネットや他のデバイスとコミュニケーションするための窓口
- 車が道路を走るためにタイヤが必要なように、デバイスがネットワークを使うためにはネットワークインターフェースが必要

#### 関係性

- ネットワークはデバイス同士が情報をやり取りする仕組みであり、インターネットは世界中のネットワークが相互に接続された大きなネットワーク
- ネットワークインターフェースを通じて、デバイスはインターネットや他のデバイスと情報のやり取りを行う
- ローカルネットワークは家庭やオフィスなど限られた範囲内でのネットワークであり、Wi-Fi などでデバイス同士が直接通信する。インターネットは複数のローカルネットワークを相互に接続して、世界中のコンピューターやデバイスがやり取りする
  :::

そして、プロキシサーバはブラウザ側のネットワーク or Web サーバ側のネットワークに設置する。

![](https://storage.googleapis.com/zenn-user-upload/ba215f8c5276-20230727.png)

![](https://storage.googleapis.com/zenn-user-upload/7d1c45248811-20230727.png)

## ブラウザ側にプロキシサーバを設置するメリット

ブラウザ側にプロキシサーバを設置することを**フォワードプロキシ**という。

![](https://storage.googleapis.com/zenn-user-upload/3a2d48518527-20230727.png)

### ネットワークを効率よく利用

プロキシサーバーをブラウザ側に導入すると、複数のブラウザが直接インターネットにアクセスするのではなく、プロキシサーバーを経由してアクセスする。
これにより、Web アクセスがプロキシサーバーに集中されるため、ネットワーク上でのトラフィックの流れがより効率的になる。

### トラフィックの制御と最適化

ブラウザごとに直接インターネットにアクセスする場合、各ブラウザが独立してトラフィックを生成する。
これに対して、プロキシサーバーを使用することで、トラフィックが集中して管理されるため、トラフィックの量を抑えたり、最適化することが容易になる。
:::details トラフィックとは？
トラフィックとは、コンピュータやスマートフォンなどのデバイスがインターネットを通じてデータを送受信する際のデータの量や流れを指します。例えば、ウェブサイトを閲覧したり、動画を視聴したり、メールを送受信したりする際には、データがインターネットを介してやり取りされます。このデータのやり取りの量や流れがトラフィックです。

イメージとして、インターネットを通るデータは「車」に例えることができます。道路（インターネット）を走る車の数や速さ（データの量や流れ）がトラフィックとなります。大量のデータが同時に通過すると、道路が混雑して遅くなるように、インターネット上でもトラフィックが多くなると通信が遅くなることがあります。

プロキシサーバーがトラフィックを制御・最適化するということは、プロキシサーバーを通ることで、データの流れを効率よく整理し、インターネットの道路をスムーズに走らせるようにするということです。これにより、快適なウェブサイト閲覧や迅速なデータ通信が実現できるのです。
:::

### ネットワーク管理の簡素化

プロキシサーバーをブラウザ側に配置することで、ネットワーク管理が簡素化される。
プロキシサーバーを中央に配置することで、セキュリティ対策やトラフィック監視、コンテンツフィルタリングなどを一元的に行うことができる。
これにより、ネットワーク全体の管理が容易になる。

### キャッシュによるレスポンスの高速化

プロキシサーバが Web アクセスを中継する際、オリジンサーバのリソースをキャッシュする。
次に同じリクエストが発生した際は、このキャッシュデータを再利用してレスポンスの高速化が可能になる。

### セキュリティ向上

- プロキシサーバで Web サーバとの通信をチェックし、危険であると判断した場合は通信を遮断する
  - このような機能を**WAF**（Web Application Firewall）と呼ぶ
- Web コンテンツのウイルスチェックやスキャンをしてくれる
- Web サーバの URL チェックをしてくれる

## Web サーバ側にプロキシサーバを設置するメリット

Web サーバ側にプロキシサーバを設置することを**リバースプロキシ**という。

![](https://storage.googleapis.com/zenn-user-upload/861403d4a564-20230727.png)

### キャッシュによるレスポンスの高速化

フォワードプロキシと同じ。

### リクエストの分散

Web サーバ側に設置するプロキシは、リクエストを複数のバックエンドサーバに分散させることができる。
これにより、負荷分散が可能。
このことを**ロードバランシング**と呼ぶ。
オリジンサーバへの振り分けには**URL**マッピングという手法が用いられる。

### オリジンサーバの保護

ロードバランシングにより、Web サーバの構成を外部から隠蔽することができる。
