---
title: "ロードバランサー"
---

## ロードバランサーとは

- クライアントからのリクエストを複数のサーバに分散させるための仕組みのこと
- Web サーバにかかる負担を減らして、大量のリクエストを捌くための方法として以下の 2 つがある
  - スケールアップ
  - スケールアウト
    詳しくは[こちら](https://zenn.dev/yuu104/books/web-technology-textbook/viewer/faster-and-larger-scale-web-systems)
- スケールアウトはスケーラビリティや耐障害性で有利であるが、クライアントからのリクエストを複数のサーバに分散させるための特別な仕組みが必要になる
- この仕組みを可能にするのが**ロードバランサー（負荷分散装置）**

![](https://storage.googleapis.com/zenn-user-upload/dedfa6d69fe3-20230730.png)

- ロードバランサーには Web サーバにインストールして利用するものから、専用機器まで数多くある
- 専用機器を使用したロードバランサーのメリット
  - 専用機器は、Web サーバのフロントエンドに設置することができるため、サーバ構成を大きく変える必要がない
  - 専用に設計されているため、専門的なチューニングをする必要もない

## ロードバランサーの負荷分散方式

![](https://storage.googleapis.com/zenn-user-upload/736bbbc87bb4-20230730.png)

### ラウンドロビン方式

- 単純に順番通りに各サーバに割り振る

### 優先順位方式

- 各オリジンサーバに**優先順位（Priority）**を設定し、優先順位の高いサーバからリクエストを割り振る
- 一定数割り振ったら、次に優先順位の高いサーバに割り振る
- 優先順位が低いオリジンサーバは、アクセスが集中した場合のみ利用する
- 優先度を最も低いサーバには、「アクセス集中のため表示できません」などの Web ページを用意しておき、アクセスが集中していることを告知するために利用したりする

![](https://storage.googleapis.com/zenn-user-upload/e7c3138a9236-20230730.png)

### 重み付け方式

- 割り当てるオリジンサーバの頻度を**重み（Raito）**で変えることができる
- オリジンサーバの性能に差がある場合、低スペックなサーバへの割り振りは減らし、高スペックなサーバへの割り振りは増やすなどの対応が可能
- 高スペックなサーバに対する重みを「3」、低スペックなサーバに対する重みを「１」に設定することで、アクセスを「3:1」の割合で割り振ることができる

![](https://storage.googleapis.com/zenn-user-upload/64c1b5814cd3-20230730.png)
