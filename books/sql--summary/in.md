---
title: "IN句"
---

「カラムの値が指定した値のリストのいずれかに一致する」という条件を作ることができる。

## 基本構文

```sql
SELECT * FROM テーブル
WHERE カラム IN (値1,値2,値3...);
```

- `IN` 句では、カッコの中に値をカンマ区切りで指定していく
- これにより、カラムの値が `(値1,値2,値3...)` のいずれかに一致するという条件式が成立する

`IN` 句を使用せずとも、`OR` 演算子を使用して表現できる。

```sql
SELECT * FROM テーブル
WHERE カラム = 値1 OR カラム = 値2 OR カラム = 値3...;
```

- 上記は何度も `カラム` を記述する必要があり、見通しが悪い
- `IN` 句を使用することで、判読しやすい SQL を記述できる

## `NOT IN` 句

`IN` 句の前に `NOT` を書くことで `IN` 句の否定となり、続くカッコ内の値のいずれにも一致しないという条件になる。

```sql
SELECT * FROM テーブル
WHERE カラム NOT IN (値1,値2,値3...);
```

## 使用例

| 氏名 | 出席番号 | 数字 |
| ---- | -------- | ---- |
| 高橋 | a001     | 1    |
| 伊藤 | a002     | 2    |
| 金木 | a003     | 3    |
| 佐藤 | a004     | 4    |

`氏名` が `高橋`、`伊藤`、`山田` のいずれかであるレコードを抽出してみる。

```sql
SELECT * FROM test01
WHERE 氏名 IN ('高橋', '伊藤', '山田');
```

| 氏名 | 出席番号 | 数字 |
| ---- | -------- | ---- |
| 高橋 | a001     | 1    |
| 伊藤 | a002     | 2    |

次は、`氏名` が `高橋`、`伊藤`、`山田` のいずれにも当てはまらないレコードだけを抽出する。

```sql
SELECT * FROM test_table02
WHERE 氏名 NOT IN ('高橋', '伊藤', '山田');
```

```sql
| 氏名 | 出席番号 | 国語 |
| --- | --- | --- |
| 金木 | a003 | 3 |
| 佐藤 | a004 | 4 |
```

## `IN` 句、`NOT IN` 句でサブクエリを使用する

**`table01`**
| 氏名 | 出席番号 | 数字 |
| ---- | -------- | ---- |
| 高橋 | a001 | 1 |
| 伊藤 | a002 | 2 |

**`table02`**
| 氏名 | 出席番号 | 国語 |
| --- | --- | --- |
| 高橋 | a001 | 5 |
| 伊藤 | a002 | 6 |
| 渡辺 | a005 | 7 |
| 加藤 | a006 | 8 |

`table01` から、「`氏名` が、`table02` で `国語` の値が `6` 以上の `氏名` のいずれかに一致する」という条件でレコードを抽出する。

```sql
SELECT * FROM test01
WHERE 氏名 IN (SELECT 氏名 FROM test02 WHERE 国語 >= 6);
```

| 氏名 | 出席番号 | 数字 |
| ---- | -------- | ---- |
| 伊藤 | a002     | 2    |
